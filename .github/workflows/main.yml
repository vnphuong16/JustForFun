name: Auto commit (random times)

on:
  workflow_dispatch:
  schedule:
    - cron: '0 1 * * *'  # run once a day at 08:00 (UTC+7)

jobs:
  random_commit:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v4

      - name: Generate random commits (2–10 times/day)
        run: |
          git config --global user.name "Phuong Van"
          git config --global user.email "vnphuong16@users.noreply.github.com"

          count=$(( (RANDOM % 9) + 2 ))  # random 2–10 commits
          echo "Will make $count commits today"

          for i in $(seq 1 $count); do
            echo "$(date +%s)" > JustForFun.txt
            git add JustForFun.txt
            git commit -m "Random commit #$i on $(date -u +"%Y-%m-%dT%H:%M:%SZ")"

            # skip sleep after the last commit
            if [ $i -lt $count ]; then
              delay=$(( (RANDOM % 26 + 5) * 60 ))  # 5–30 minutes
              echo "Sleeping for $((delay / 60)) minutes..."
              sleep $delay
            fi
          done

          git push